#functions to take daily forecasted volumes and handled times to workload
#hours, staff hours required, and FTE required
fteHrsPerDay = 7.75
fteHrsPerWeek = 38.75
#Create & Populate Year from Date
require(zoo)
#zoo must be loaded, date must be defined
yearFromDate = function(xDate){
  year = format(xDate, "%Y")
  return(year)
}
date1 = as.Date("2016-02-13", "%Y-%m-%d")
#return month from formatted date
monthFromDate = function(xDate){
  month = format(xDate, "%b")
  return(month)
}
#return day of week(DOW) from date
dow = function(xDate){
  x = weekdays(as.Date(xDate))
  return(x)
}
#return the date of Monday from the current week with Monday as the first
#day of the week.
weekof = function(xDate){
  x = xDate
  y = 0
  while(dow(x-y)!="Monday"){
    y = y+1;
  }
  return(x-y)
}
#calculate workload hours from call volume and AHT in seconds
wkldHrs = function(cv, aht){
  x = cv*aht/60/60
  return(x)
}
#calculate staff hours required
staffHrsReq = function(wkldHrs, RSF){
  x = wkldHrs*RSF
  return(x)
}
#Calculate FTE Required
fteReq = function(staffHrsReq){
  x = staffHrsReq/fteHrsPerDay
  return(x)
}
#Calculate Presence Factor
presenceFactor = function(yourTime, holiday, otherPaid, fteHrsPerMonth){
  x = 1 - ((yourTime/(fteHrsPerWeek*2)) + (holiday/fteHrsPerMonth) + (otherPaid/fteHrsPerMonth))
  return(x)
}

yt <- c(7.3671, 7.8933, 8.2880)
hol <- c(6.1, 0, 0)
op <- c(8.17493, 8.11338, 8.45929)
fte <- c(170.690, 155, 170.690)
presenceFactor(yt, hol, op, fte)
#calculate Scheduled Rate

